import logging

_logger = logging.getLogger(__name__)

malware_profile_data = [
    {
        "id": "1",
        "name": "Red Line Stealer",
        "description": "This malware harvests information from browsers such as saved credentials, autocomplete data, and credit card information. A system inventory is also taken when running on a target machine, to include details such as the username, location data, hardware configuration, and information regarding installed security software.",
        "prevention_techniques": "Store passwords securely, such as in an encrypted password manager rather than in web browsers \
            \nRefrain from downloading pirated software applications and only download official software applications from trusted sources such as Microsoft and Adobe. \
            \nUpdate systems, applications and software to the latest version and download the latest security patches. \
            \nInstall anti-virus/anti-malware software and keep the software (and its definition files) updated. Perform a scan of the systems and networks regularly and scan all received files.",
    },
    {
        "id": "2",
        "name": "Downloader",
        "description": "This type of malware doesn't contain the main malicious payload itself. Instead, it's a 'downloader' that connects to a command and control (C2) server, downloads a malicious program, and then installs it on the victim's system. ",
        "prevention_techniques": "Avoid clicking on suspicious links or opening attachments from unknown senders. Malicious websites and emails can deliver malware downloads. \
            \nOnly allow authorized applications to run, preventing unauthorized programs from installing and executing. \
            \nScan portable storage devices (like USB drives) with up-to-date antivirus software before using them. \
            \nCreate periodic backups of your system and restore to a known good state if an infection is detected. ",
    },
    {
        "id": "3",
        "name": "RAT",
        "description": "Remore Access Trojan or RAT, is designed to allow an attacker to remotely control a computer similar to how the Remote Desktop Protocol (RDP) and TeamViewer can be used for remote access or system administration. The RAT will set up a command and control (C2) channel with the attacker's server over which commands can be sent to the RAT, and data can be sent back. RATs commonly have a set of built-in commands and have methods for hiding their C2 traffic from detection.",
        "prevention_techniques": "Install and maintain anti-malware software that can detect and block RATs. Keep your software updated to the latest version for the best protection. \
            \nRegularly scan your systems for malware using anti-malware software to catch infections early and prevent them from spreading. \
            \nIf using remote access, implement secure gateways and other security measures to protect against unauthorized access. \
            \nImplement anti-phishing solutions to protect against phishing emails and websites that might try to trick users into installing RATs.",
    },
    {
        "id": "4",
        "name": "Banking Trojan",
        "description": "Banking Trojans are malware designed to collect online banking credentials and other sensitive information from infected machines.",
        "prevention_techniques": "Keep your operating system, browsers, and security software (antivirus, anti-malware) up-to-date with the latest patches and updates. This helps address known vulnerabilities that Trojans might exploit. \
            \nUse strong, unique passwords for all online accounts, including your bank accounts. Consider using a password manager to generate and store complex passwords securely. \
            \nBe aware of suspicious activity on banking and financial services websites. Look for unusual login fields, requests for personal data, or other unusual behavior. \
            \nBe cautious when using public Wi-Fi networks, as they can be vulnerable to eavesdropping and malware attacks. ",
    },
    {
        "id": "5",
        "name": "Snake Key Logger",
        "description": "Snake Keylogger is a malware that is commonly spread via phishing and spear phishing campaigns. A malicious Office document or PDF is attached to the email. If the recipient opens the document and enables macros or uses a vulnerable version of Office or a PDF reader, then the malware is executed. Some of its key capabilities include keylogging, stealing saved credentials, taking screenshots, and collecting data from clipboards to be sent to the attacker.",
        "prevention_techniques": "The goal of Snake Keylogger and similar credential stealers is to collect user login credentials to allow the malware operator to take over a userâ€™s account. Strong MFA makes it more difficult for attackers to use the stolen passwords to access user accounts because it also requires access to the other authentication factor \
            \nImplementing zero trust, with its least privilege access controls, limits the potential impacts of a compromised user account \
            \nSnake Keylogger spreads via malicious email attachments, including documents that download and run the malware. Email security solutions can identify and block emails containing malicious attachments.",
    },
    {
        "id": "6",
        "name": "Spyware",
        "description": "Spyware is a type of malware designed to secretly gather information about a user or organization and transmit it to a third party without their knowledge or consent. It can be installed on a device without the user's permission and can monitor various aspects of their activity, including websites visited, emails, passwords, and more. This information can be used for malicious purposes, such as identity theft or data breaches. ",
        "prevention_techniques": "Install and regularly update a reputable antivirus or anti-malware program with spyware protection capabilities. \
            \nUse safe browser practices like avoid clicking suspicious link, ads or downloading strange software \
            \nBe wary of scam messages and avoid clicking on links or opening attachments in emails or text messages from unknown senders. \
            \nEnsure your firewall is enabled and configured to block unauthorized access to your device.",
    }
]

class MalwareProfileService:
    @staticmethod
    async def get_malware_profile_list() -> tuple[list[dict], int]:
        count = len(malware_profile_data)
        return malware_profile_data, count
    
    @staticmethod
    async def get_malware_profile_by_id(id: str) -> dict:
        for malware_profile in malware_profile_data:
            if malware_profile["id"] == id:
                return malware_profile
        return None