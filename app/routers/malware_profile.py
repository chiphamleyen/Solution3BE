from fastapi import APIRouter

from app.dto.common import BasePaginationResponseData, BaseResponseData
from app.services.malware_profile_services import MalwareProfileService

router = APIRouter(tags=['Malware Profile'], prefix="/malware_profile")

@router.get(
    "/list"
)
async def get_list_malware_profile():
    malware_profile_data, total = await MalwareProfileService.get_malware_profile_list()
    return BasePaginationResponseData(
        items=malware_profile_data,
        page=1,
        size=len(malware_profile_data),
        total=total
    )

@router.get(
    "/{id}"
)
async def get_malware_by_id(
    id: str
):
    malware_profile_data = await MalwareProfileService.get_malware_profile_by_id(id)
    if malware_profile_data is None:
        return BaseResponseData(
            message="Malware profile not found",
            error_code=404
        )
    return BaseResponseData(
        data=malware_profile_data,
        message="Success",
    )